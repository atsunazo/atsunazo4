<div className="w-full flex justify-center">
    <div className="w-full flex justify-end">
        <div className="flex flex-row-reverse gap-[3px]" style={{ width: 'calc(100% - 1px)' }}>
            {hiraganaGrid.map((row, rowIndex) => (
                <div key={rowIndex} className="flex flex-col gap-[3px] flex-1">
                    {row.map((char) => (
                        <button
                            key={char}
                            onClick={() => handleCharacterClick(char)}
                            disabled={isAnswered || isSubmitting}
                            className={`w-full aspect-square text-sm rounded-md border font-inter ${
                                char === ""
                                    ? "invisible"
                                    : (isAnswered || isSubmitting)
                                    ? "bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-800 dark:text-gray-600 border-gray-200 dark:border-gray-700"
                                    : char === "×"
                                    ? "bg-red-50 hover:bg-red-100 text-red-600 border-red-200 dark:bg-red-900/20 dark:hover:bg-red-900/30 dark:text-red-400 dark:border-red-800"
                                    : ["゛", "゜", "小"].includes(char)
                                    ? "bg-blue-50 hover:bg-blue-100 text-blue-600 border-blue-200 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 dark:text-blue-400 dark:border-blue-800"
                                    : "border-gray-200 dark:border-gray-700 text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-800"
                            }`}
                        >
                            {char}
                        </button>
                    ))}
                </div>
            ))}
        </div>
    </div>
</div>
const hiraganaGrid = [
    ["あ", "い", "う", "え", "お"],
    ["か", "き", "く", "け", "こ"],
    ["さ", "し", "す", "せ", "そ"],
    ["た", "ち", "つ", "て", "と"],
    ["な", "に", "ぬ", "ね", "の"],
    ["は", "ひ", "ふ", "へ", "ほ"],
    ["ま", "み", "む", "め", "も"],
    ["や", "", "ゆ", "", "よ"],
    ["ら", "り", "る", "れ", "ろ"],
    ["わ", "", "", "", "を"],
    ["ん", "゛", "゜", "小", "×"]
];

const dakutenMap = {
    か: "が", き: "ぎ", く: "ぐ", け: "げ", こ: "ご",
    さ: "ざ", し: "じ", す: "ず", せ: "ぜ", そ: "ぞ",
    た: "だ", ち: "ぢ", つ: "づ", て: "で", と: "ど",
    は: "ば", ひ: "び", ふ: "ぶ", へ: "べ", ほ: "ぼ",
    が: "か", ぎ: "き", ぐ: "く", げ: "け", ご: "こ",
    ざ: "さ", じ: "し", ず: "す", ぜ: "せ", ぞ: "そ",
    だ: "た", ぢ: "ち", づ: "つ", で: "て", ど: "と",
    ば: "は", び: "ひ", ぶ: "ふ", べ: "へ", ぼ: "ほ",
    ぱ: "ば", ぴ: "び", ぷ: "ぶ", ぺ: "べ", ぽ: "ぼ"
};

const handakutenMap = {
    は: "ぱ", ひ: "ぴ", ふ: "ぷ", へ: "ぺ", ほ: "ぽ",
    ば: "ぱ", び: "び", ぶ: "ぶ", べ: "べ", ぼ: "ぼ",
    ぱ: "ば", ぴ: "び", ぷ: "ぶ", ぺ: "べ", ぽ: "ぼ"
};

const smallMap = {
    つ: "っ", や: "ゃ", ゆ: "ゅ", よ: "ょ",
    あ: "ぁ", い: "ぃ", う: "ぅ", え: "ぇ", お: "ぉ",
    っ: "つ", ゃ: "や", ゅ: "ゆ", ょ: "よ",
    ぁ: "あ", ぃ: "い", ぅ: "う", ぇ: "え", ぉ: "お"
};

const handleCharacterClick = (char) => {
    if (isAnswered) return;

    if (char === "×") {
        setAnswer(prev => prev.slice(0, -1));
        return;
    }

    if (char === "゛" || char === "゜" || char === "小") {
        const lastChar = answer.slice(-1);
        if (char === "゛" && dakutenMap[lastChar]) {
            setAnswer(prev => prev.slice(0, -1) + dakutenMap[lastChar]);
        } else if (char === "゜" && handakutenMap[lastChar]) {
            setAnswer(prev => prev.slice(0, -1) + handakutenMap[lastChar]);
        } else if (char === "小" && smallMap[lastChar]) {
            setAnswer(prev => prev.slice(0, -1) + smallMap[lastChar]);
        }
        return;
    }

    if (char !== "") {
        setAnswer(prev => prev + char);
    }
};
